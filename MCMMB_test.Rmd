---
title: How do IUCN Range maps of birds compare to SDMs in Indonesian New Guinea? What
  are the main predictors for this distribution?
author: "Jonathan Gehret, Paul Leister"
date: "31.08.2021"
output:
  html_document:
    toc: yes
    df_print: paged
    code_folding: show
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE,  fig.align = "center")
```

# 1. Introduction


# 2. Methods

For the creation of this HTML document, the MCMMB.Rmd was knitted.
To find the species to be used for our analysis we used the loops in bird_plot_loops.R to plot all species from the Gbif and IUCN data sets to find birds with sufficient observation points and different ranges to be used for our project.

## 2.1. Main script

The required libraries and the setup of the IUCN and gbif data sets are done in the MCMMB_Main.R script. Notably, the HBIF data are created only for species with greater than 100 observations.The GBIF data were downloaded manually beforehand, however the r library "rgbif" could be used instead. Additionally, the island borders are read in and given the name "regio".

```{r main, results = FALSE, cache}
source("MCMMB_Main.R")
```


## 2.2. Species data  

The script species_loops.R includes two functions each for creating lists with the input bird species data for gbif ("get_gbif_birds(bird_names,gbif_crop,regio)") and IUCN ("get_iucn_birds(bird_names,birdlife,regio)") and plotting them, respectively.

```{r species_loops, fig.height = 5, fig.width = 10}
# loading of the described functions
source("species_loops.R")

# cassowaries didn't have enough data
#bird_names = c("Casuarius bennetti", "Casuarius casuarius", "Casuarius unappendiculatus")

# we chose Pachycephala instead
bird_names = c("Pachycephala lorentzi", 
               "Pachycephala meyeri", 
               "Pachycephala schlegelii",
               "Pachycephala simplex",
               "Pachycephala soror")

# these names can be changed to any other bird species occuring in the data sets, for fully automated creation of sdms following this markdown file:
# bird_names = c(your_favorite_species_here)

# for plotting gbif data next to iucn data
par(mfrow = c(2,length(bird_names)))

# create list with birds out of the iucn and gbif data and plot them
# IUCN birdlife data is shown in red
# GBIF points are shown in green
iucn_birds = get_iucn_birds(bird_names,birdlife,regio)
gbif_birds = get_gbif_birds(bird_names,gbif_crop,regio)
```

## 2.3. Create presence-absence data

While biomod2 also brings with it capabilities to create pseudo-absence data, we built a script to do it. First centroids for the area were created, based on that an equal number to the presence data of absence points is created.

    "Be sure to take care when considering the use of pseudo-absences versus true absences for species distribution
    modeling. Similarly, it is extremely important to consider the influence of sampling bias in the data used to
    train models. Further reading: e.g., Guillera-Arroita et al. 2015, Kramer-Schadt et al. 2013, and Merow et al
    2013."
    

```{r presence_absence}
# load presence_absence.R script including the function
source("presence_absence.R")
par(mfrow = c(1,5))
presence_absence_list = create_pseudo_absence(regio,gbif_birds)
```